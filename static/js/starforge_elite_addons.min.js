/* FundChamps Starforge Elite Addons â€” 10 one-liner upgrades */
try{const p=new URLSearchParams(location.search);document.querySelectorAll('a[href*="/donate"],a[href*="stripe.com"]').forEach(a=>{try{const u=new URL(a.getAttribute('href'),location);['utm_source','utm_medium','utm_campaign','utm_content','utm_term','ref'].forEach(k=>p.get(k)&&u.searchParams.set(k,p.get(k)));a.setAttribute('href',u.toString());}catch{}});}catch{}
try{const t=new URLSearchParams(location.search).get('tier');if(t){const el=[...document.querySelectorAll('#tiers [data-tier]')].find(e=>(e.dataset.tier||'').toLowerCase()===t.toLowerCase());el&&(el.classList.add('is-selected'),el.scrollIntoView({behavior:'smooth',block:'center'}),el.focus&&el.focus({preventScroll:true}));}}catch{}
addEventListener('click',e=>{const b=e.target.closest?.('[data-tier-cta]');if(!b)return;const c=b.closest('.tier');try{localStorage.setItem('fc_last_intent',JSON.stringify({tier:c?.dataset?.tier||'',amount:c?.dataset?.amount||'',at:Date.now()}));}catch{}});
document.addEventListener('click',e=>{const a=e.target.closest?.('a[href="#tiers"]');if(!a)return;e.preventDefault();document.getElementById('tiers')?.scrollIntoView({behavior:'smooth',block:'start'});});
try{document.querySelectorAll('#tiers [data-slots-left]').forEach(n=>{const m=n.textContent.match(/Only\s(\d+)\sleft/i);if(m&&+m[1]<=2){n.setAttribute('role','status');n.setAttribute('aria-live','assertive');}});}catch{}
try{window.ApplePaySession&&ApplePaySession.canMakePayments()&&document.documentElement.classList.add('fc-apple-pay');}catch{}
addEventListener('keydown',e=>{if(e.key!=='+'&&e.key!=='=')return;const i=document.getElementById('donate-custom');if(!i)return;const v=parseInt(i.value||i.placeholder||'0',10)||0;i.value=String(v+25);i.dispatchEvent(new Event('input'));});
try{document.querySelectorAll('[data-urgency-deadline]').forEach(el=>{const d=new Date(el.dataset.urgencyDeadline||el.getAttribute('data-urgency-deadline'));if(!isNaN(d))el.title='Deadline: '+d.toLocaleString();});}catch{}
addEventListener('fc:donation:success',e=>{try{(window.dataLayer=window.dataLayer||[]).push({event:'donation_success',amount:e.detail?.amount||0,total:e.detail?.total||0,at:Date.now()});}catch{}});
try{document.querySelectorAll('a[href*="stripe.com"],a[href*="paypal.com"]').forEach(a=>{a.target='_blank';a.rel='noopener noreferrer';try{const u=new URL(a.href);u.searchParams.set('utm_campaign','donor_checkout');a.href=u.toString();}catch{}});}catch{}
