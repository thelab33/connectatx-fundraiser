[
  {
    "check": "structure",
    "severity": "ok",
    "message": "Found init",
    "file": "/home/cyberboyz/connectatx-fundraiser/app/__init__.py",
    "ref": null,
    "line": null,
    "extra": null
  },
  {
    "check": "structure",
    "severity": "ok",
    "message": "Found routes_dir",
    "file": "/home/cyberboyz/connectatx-fundraiser/app/routes",
    "ref": null,
    "line": null,
    "extra": null
  },
  {
    "check": "structure",
    "severity": "ok",
    "message": "Found templates",
    "file": "/home/cyberboyz/connectatx-fundraiser/app/templates",
    "ref": null,
    "line": null,
    "extra": null
  },
  {
    "check": "structure",
    "severity": "ok",
    "message": "Found static",
    "file": "/home/cyberboyz/connectatx-fundraiser/app/static",
    "ref": null,
    "line": null,
    "extra": null
  },
  {
    "check": "structure",
    "severity": "ok",
    "message": "Suggested file present",
    "file": "/home/cyberboyz/connectatx-fundraiser/app/templates/base.html",
    "ref": null,
    "line": null,
    "extra": null
  },
  {
    "check": "structure",
    "severity": "ok",
    "message": "Suggested file present",
    "file": "/home/cyberboyz/connectatx-fundraiser/app/templates/partials/ui_bootstrap.html",
    "ref": null,
    "line": null,
    "extra": null
  },
  {
    "check": "config",
    "severity": "ok",
    "message": "Found __init__.py",
    "file": "/home/cyberboyz/connectatx-fundraiser/app/config/__init__.py",
    "ref": null,
    "line": null,
    "extra": null
  },
  {
    "check": "config",
    "severity": "ok",
    "message": "Found team_config.py",
    "file": "/home/cyberboyz/connectatx-fundraiser/app/config/team_config.py",
    "ref": null,
    "line": null,
    "extra": null
  },
  {
    "check": "config",
    "severity": "ok",
    "message": "Found config.py",
    "file": "/home/cyberboyz/connectatx-fundraiser/app/config/config.py",
    "ref": null,
    "line": null,
    "extra": null
  },
  {
    "check": "routes",
    "severity": "ok",
    "message": "Homepage route '/' present",
    "file": null,
    "ref": null,
    "line": null,
    "extra": null
  },
  {
    "check": "routes",
    "severity": "warn",
    "message": "Blueprint 'main' not registered",
    "file": null,
    "ref": null,
    "line": null,
    "extra": null
  },
  {
    "check": "routes",
    "severity": "warn",
    "message": "Endpoint 'main.donate' not found (some widgets will fallback)",
    "file": null,
    "ref": null,
    "line": null,
    "extra": null
  },
  {
    "check": "routes",
    "severity": "warn",
    "message": "Endpoint 'main.stats_json' not found (some widgets will fallback)",
    "file": null,
    "ref": null,
    "line": null,
    "extra": null
  },
  {
    "check": "env",
    "severity": "ok",
    "message": "FLASK_ENV set",
    "file": null,
    "ref": null,
    "line": null,
    "extra": null
  },
  {
    "check": "env",
    "severity": "ok",
    "message": "FLASK_CONFIG set",
    "file": null,
    "ref": null,
    "line": null,
    "extra": null
  },
  {
    "check": "env",
    "severity": "ok",
    "message": "FLASK_DEBUG set",
    "file": null,
    "ref": null,
    "line": null,
    "extra": null
  },
  {
    "check": "env",
    "severity": "ok",
    "message": "DATABASE_URL set",
    "file": null,
    "ref": null,
    "line": null,
    "extra": null
  },
  {
    "check": "env",
    "severity": "warn",
    "message": "STRIPE_API_KEY is unset",
    "file": null,
    "ref": null,
    "line": null,
    "extra": null
  },
  {
    "check": "env",
    "severity": "ok",
    "message": "SECRET_KEY set",
    "file": null,
    "ref": null,
    "line": null,
    "extra": null
  },
  {
    "check": "db",
    "severity": "ok",
    "message": "Connected to DB",
    "file": null,
    "ref": null,
    "line": null,
    "extra": null
  },
  {
    "check": "a11y",
    "severity": "info",
    "message": "Anchor href=\"#\" found (consider role='button' + JS handler)",
    "file": "/home/cyberboyz/connectatx-fundraiser/app/templates/home.html",
    "ref": null,
    "line": null,
    "extra": null
  },
  {
    "check": "a11y",
    "severity": "info",
    "message": "No ARIA attributes detected in file (may be fine)",
    "file": "/home/cyberboyz/connectatx-fundraiser/app/templates/error.html",
    "ref": null,
    "line": null,
    "extra": null
  },
  {
    "check": "a11y",
    "severity": "info",
    "message": "Anchor href=\"#\" found (consider role='button' + JS handler)",
    "file": "/home/cyberboyz/connectatx-fundraiser/app/templates/index.html",
    "ref": null,
    "line": null,
    "extra": null
  },
  {
    "check": "a11y",
    "severity": "info",
    "message": "Anchor href=\"#\" found (consider role='button' + JS handler)",
    "file": "/home/cyberboyz/connectatx-fundraiser/app/templates/partials/newsletter.html",
    "ref": null,
    "line": null,
    "extra": null
  },
  {
    "check": "html",
    "severity": "warn",
    "message": "Duplicate id attributes found",
    "file": "/home/cyberboyz/connectatx-fundraiser/app/templates/partials/sponsor_form.html",
    "ref": null,
    "line": null,
    "extra": {
      "duplicates": [
        "donor-name",
        "donor-name",
        "donor-email",
        "donor-email",
        "donation-amount",
        "donation-amount"
      ]
    }
  },
  {
    "check": "a11y",
    "severity": "info",
    "message": "Anchor href=\"#\" found (consider role='button' + JS handler)",
    "file": "/home/cyberboyz/connectatx-fundraiser/app/templates/partials/about_section.html",
    "ref": null,
    "line": null,
    "extra": null
  },
  {
    "check": "a11y",
    "severity": "warn",
    "message": "Image missing alt attribute",
    "file": "/home/cyberboyz/connectatx-fundraiser/app/templates/partials/ui_bootstrap.html",
    "ref": null,
    "line": null,
    "extra": null
  },
  {
    "check": "csp",
    "severity": "warn",
    "message": "Inline <script> without nonce attribute",
    "file": "/home/cyberboyz/connectatx-fundraiser/app/templates/partials/ui_bootstrap.html",
    "ref": null,
    "line": null,
    "extra": null
  },
  {
    "check": "csp",
    "severity": "warn",
    "message": "Inline <script> without nonce attribute",
    "file": "/home/cyberboyz/connectatx-fundraiser/app/templates/partials/ui_bootstrap.html",
    "ref": null,
    "line": null,
    "extra": null
  },
  {
    "check": "csp",
    "severity": "warn",
    "message": "Inline <script> without nonce attribute",
    "file": "/home/cyberboyz/connectatx-fundraiser/app/templates/partials/ui_bootstrap.html",
    "ref": null,
    "line": null,
    "extra": null
  },
  {
    "check": "a11y",
    "severity": "info",
    "message": "No ARIA attributes detected in file (may be fine)",
    "file": "/home/cyberboyz/connectatx-fundraiser/app/templates/partials/sponsor_spotlight.html",
    "ref": null,
    "line": null,
    "extra": null
  },
  {
    "check": "a11y",
    "severity": "info",
    "message": "No ARIA attributes detected in file (may be fine)",
    "file": "/home/cyberboyz/connectatx-fundraiser/app/templates/admin/sponsors.html",
    "ref": null,
    "line": null,
    "extra": null
  },
  {
    "check": "csp",
    "severity": "warn",
    "message": "Inline <script> without nonce attribute",
    "file": "/home/cyberboyz/connectatx-fundraiser/app/templates/macros/confetti.html",
    "ref": null,
    "line": null,
    "extra": null
  },
  {
    "check": "a11y",
    "severity": "info",
    "message": "No ARIA attributes detected in file (may be fine)",
    "file": "/home/cyberboyz/connectatx-fundraiser/app/templates/macros/confetti.html",
    "ref": null,
    "line": null,
    "extra": null
  },
  {
    "check": "a11y",
    "severity": "info",
    "message": "No ARIA attributes detected in file (may be fine)",
    "file": "/home/cyberboyz/connectatx-fundraiser/app/templates/macros/starforge.html",
    "ref": null,
    "line": null,
    "extra": null
  },
  {
    "check": "csp",
    "severity": "warn",
    "message": "Inline <script> without nonce attribute",
    "file": "/home/cyberboyz/connectatx-fundraiser/app/templates/macros/sponsor_card.html",
    "ref": null,
    "line": null,
    "extra": null
  },
  {
    "check": "csp",
    "severity": "warn",
    "message": "Inline <script> without nonce attribute",
    "file": "/home/cyberboyz/connectatx-fundraiser/app/templates/macros/sponsor_card.html",
    "ref": null,
    "line": null,
    "extra": null
  },
  {
    "check": "csp",
    "severity": "warn",
    "message": "Inline <script> without nonce attribute",
    "file": "/home/cyberboyz/connectatx-fundraiser/app/templates/macros/sponsor_card.html",
    "ref": null,
    "line": null,
    "extra": null
  },
  {
    "check": "health",
    "severity": "info",
    "message": "/status returned 404",
    "file": null,
    "ref": null,
    "line": null,
    "extra": null
  },
  {
    "check": "headers",
    "severity": "fail",
    "message": "Content-Security-Policy missing",
    "file": null,
    "ref": null,
    "line": null,
    "extra": null
  },
  {
    "check": "headers",
    "severity": "warn",
    "message": "Strict-Transport-Security missing",
    "file": null,
    "ref": null,
    "line": null,
    "extra": null
  },
  {
    "check": "headers",
    "severity": "ok",
    "message": "X-Frame-Options set",
    "file": null,
    "ref": null,
    "line": null,
    "extra": null
  },
  {
    "check": "headers",
    "severity": "ok",
    "message": "Referrer-Policy set",
    "file": null,
    "ref": null,
    "line": null,
    "extra": null
  },
  {
    "check": "headers",
    "severity": "warn",
    "message": "Permissions-Policy missing",
    "file": null,
    "ref": null,
    "line": null,
    "extra": null
  },
  {
    "check": "cookies",
    "severity": "info",
    "message": "Cookie 'session' missing SameSite",
    "file": null,
    "ref": null,
    "line": null,
    "extra": null
  },
  {
    "check": "js",
    "severity": "info",
    "message": "console.log present",
    "file": "/home/cyberboyz/connectatx-fundraiser/app/static/js/app.entry.js",
    "ref": null,
    "line": null,
    "extra": null
  },
  {
    "check": "js",
    "severity": "info",
    "message": "'undefined' literal appears (may be fine)",
    "file": "/home/cyberboyz/connectatx-fundraiser/app/static/js/bundle.min.js",
    "ref": null,
    "line": null,
    "extra": null
  },
  {
    "check": "js",
    "severity": "warn",
    "message": "eval() usage detected",
    "file": "/home/cyberboyz/connectatx-fundraiser/app/static/js/bundle.min.js",
    "ref": null,
    "line": null,
    "extra": null
  },
  {
    "check": "tools",
    "severity": "warn",
    "message": "ruff check",
    "file": null,
    "ref": null,
    "line": null,
    "extra": {
      "exit": 2,
      "out": "",
      "err": "error: invalid value 'text' for '--output-format <OUTPUT_FORMAT>'\n  [possible values: concise, full, json, json-lines, junit, grouped, github, gitlab, pylint, rdjson, azure, sarif]\n\nFor more information, try '--help'.\n"
    }
  },
  {
    "check": "tools",
    "severity": "warn",
    "message": "bandit security scan",
    "file": null,
    "ref": null,
    "line": null,
    "extra": {
      "exit": 1,
      "out": "---------------------------------\n>> Issue: [B113:request_without_timeout] Call to requests without timeout\n   Severity: Medium   Confidence: Low\n   CWE: CWE-400 (https://cwe.mitre.org/data/definitions/400.html)\n   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b113_request_without_timeout.html\n   Location: app/routes/api.py:502:16\n501\t        tok = _paypal_token()\n502\t        order = requests.post(\n503\t            f\"{_paypal_base()}/v2/checkout/orders\",\n504\t            headers={\"Content-Type\": \"application/json\", \"Authorization\": f\"Bearer {tok}\"},\n505\t            json={\n506\t                \"intent\": \"CAPTURE\",\n507\t                \"purchase_units\": [{\n508\t                    \"amount\": {\n509\t                        \"currency_code\": currency.upper(),\n510\t                        \"value\": value\n511\t                    },\n512\t                    \"custom_id\": (data.get(\"allocation\") or \"general\"),  # shows up in reports\n513\t                }],\n514\t                \"application_context\": {\n515\t                    \"shipping_preference\": \"NO_SHIPPING\",\n516\t                    \"brand_name\": _cfg(\"TEAM_BRAND\", \"FundChamps\"),\n517\t                    \"user_action\": \"PAY_NOW\",\n518\t                },\n519\t            },\n520\t            timeout=_paypal_timeout(),\n521\t        )\n522\t        order.raise_for_status()\n\n--------------------------------------------------\n>> Issue: [B113:request_without_timeout] Call to requests without timeout\n   Severity: Medium   Confidence: Low\n   CWE: CWE-400 (https://cwe.mitre.org/data/definitions/400.html)\n   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b113_request_without_timeout.html\n   Location: app/routes/api.py:542:14\n541\t        tok = _paypal_token()\n542\t        cap = requests.post(\n543\t            f\"{_paypal_base()}/v2/checkout/orders/{order_id}/capture\",\n544\t            headers={\"Content-Type\": \"application/json\", \"Authorization\": f\"Bearer {tok}\"},\n545\t            timeout=_paypal_timeout() + 5,\n546\t        )\n547\t        cap.raise_for_status()\n\n--------------------------------------------------\n>> Issue: [B110:try_except_pass] Try, Except, Pass detected.\n   Severity: Low   Confidence: High\n   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)\n   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b110_try_except_pass.html\n   Location: app/routes/api.py:556:8\n555\t            amount = float(amt.get(\"value\", \"0.00\"))\n556\t        except Exception:\n557\t            pass\n558\t        return jsonify({\"status\": status, \"amount\": amount})\n\n--------------------------------------------------\n>> Issue: [B324:hashlib] Use of weak SHA1 hash for security. Consider usedforsecurity=False\n   Severity: High   Confidence: High\n   CWE: CWE-327 (https://cwe.mitre.org/data/definitions/327.html)\n   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b324_hashlib.html\n   Location: app/routes/main.py:128:11\n127\t    seed = f\"{int(context.get('raised', 0))}-{int(context.get('goal', 0) or 0)}-{len(context.get('sponsors_sorted', []))}-{int(context.get('percent', 0))}\"\n128\t    return sha1(seed.encode(\"utf-8\")).hexdigest()[:12]\n129\t\n\n--------------------------------------------------\n>> Issue: [B110:try_except_pass] Try, Except, Pass detected.\n   Severity: Low   Confidence: High\n   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)\n   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b110_try_except_pass.html\n   Location: app/routes/sms.py:236:4\n235\t        _verify_twilio_signature()\n236\t    except Exception:\n237\t        pass  # Signature already handles abort if needed\n238\t\n\n--------------------------------------------------\n\nCode scanned:\n\tTotal lines of code: 4061\n\tTotal lines skipped (#nosec): 0\n\tTotal potential issues skipped due to specifically being disabled (e.g., #nosec BXXX): 0\n\nRun metrics:\n\tTotal issues (by severity):\n\t\tUndefined: 0\n\t\tLow: 9\n\t\tMedium: 4\n\t\tHigh: 1\n\tTotal issues (by confidence):\n\t\tUndefined: 0\n\t\tLow: 4\n\t\tMedium: 0\n\t\tHigh: 10\nFiles skipped (0):\n",
      "err": ""
    }
  },
  {
    "check": "tools",
    "severity": "warn",
    "message": "pytest suite",
    "file": null,
    "ref": null,
    "line": null,
    "extra": {
      "exit": 2,
      "out": "\n==================================== ERRORS ====================================\n_________________ ERROR collecting tests/test_example_model.py _________________\nImportError while importing test module '/home/cyberboyz/connectatx-fundraiser/tests/test_example_model.py'.\nHint: make sure your test modules/packages have valid Python names.\nTraceback:\n../.pyenv/versions/3.12.3/lib/python3.12/importlib/__init__.py:90: in import_module\n    return _bootstrap._gcd_import(name[level:], package, level)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\ntests/test_example_model.py:2: in <module>\n    from app import create_app, db\nE   ModuleNotFoundError: No module named 'app'\n=========================== short test summary info ============================\nERROR tests/test_example_model.py\n!!!!!!!!!!!!!!!!!!!! Interrupted: 1 error during collection !!!!!!!!!!!!!!!!!!!!\n1 error in 0.43s\n",
      "err": ""
    }
  }
]
