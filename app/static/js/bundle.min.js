/* FundChamps bundle | production | 4b1c2341 | 2025-09-04T05:14:37.330Z */
(()=>{var Se=Object.create;var Y=Object.defineProperty;var be=Object.getOwnPropertyDescriptor;var Le=Object.getOwnPropertyNames;var Te=Object.getPrototypeOf,_e=Object.prototype.hasOwnProperty;var z=(o=>typeof require<"u"?require:typeof Proxy<"u"?new Proxy(o,{get:(a,s)=>(typeof require<"u"?require:a)[s]}):o)(function(o){if(typeof require<"u")return require.apply(this,arguments);throw Error('Dynamic require of "'+o+'" is not supported')});var Oe=(o,a)=>()=>(o&&(a=o(o=0)),a);var ke=(o,a,s,u)=>{if(a&&typeof a=="object"||typeof a=="function")for(let l of Le(a))!_e.call(o,l)&&l!==s&&Y(o,l,{get:()=>a[l],enumerable:!(u=be(a,l))||u.enumerable});return o};var Z=(o,a,s)=>(s=o!=null?Se(Te(o)):{},ke(a||!o||!o.__esModule?Y(s,"default",{value:o,enumerable:!0}):s,o));var Ae={};async function Ce(){if(!ee||!window.Stripe)return null;if(E)return E;E=window.Stripe(ee),I=E.elements({appearance:{theme:"night"}});let o=h("#stripe-payment-element");return o&&(te=I.create("payment",{fields:{billingDetails:"never"}}),te.mount(o)),E}var h,je,Pe,ee,E,I,te,O,ne,re=Oe(()=>{h=(o,a=document)=>a.querySelector(o),je=(o,a,s)=>(window.addEventListener(o,a,s),()=>window.removeEventListener(o,a,s)),Pe=o=>{let a=!1;return(...s)=>{a||(a=!0,o(...s))}},ee=document.querySelector('meta[name="stripe-pk"]')?.content||window.__STRIPE_PK||"";je("fc:donate:open",o=>{let a=o?.detail?.amount,s=h("#donation-amount");s&&Number.isFinite(+a)&&(s.value=String(a),s.dispatchEvent(new Event("input",{bubbles:!0}))),h("#donation-modal")?.showModal?.()},{passive:!0});O=h("#sponsor-donation-form");O&&O.addEventListener("submit",async o=>{if((O.querySelector('input[name="payment_method"]:checked')?.value||"stripe")!=="stripe")return;o.preventDefault();let s=parseFloat(h("#donation-amount")?.value||"0")||0,u=h("#donor-name")?.value||"Supporter",l=h("#donor-email")?.value||"";if(!(s<=0))try{await Ce();let f=await fetch("/api/payments/stripe/intent",{method:"POST",headers:{"Content-Type":"application/json",Accept:"application/json"},credentials:"same-origin",body:JSON.stringify({amount:s,name:u,email:l,frequency:O.querySelector('input[name="frequency"]:checked')?.value||"once"})}),{client_secret:g}=await f.json(),{error:S}=await E.confirmPayment({elements:I,clientSecret:g,confirmParams:{return_url:window.location.href}});if(S)throw S}catch(f){alert("Payment error: "+(f?.message||"Please try again."))}});document.addEventListener("click",o=>{let a=o.target.closest("[data-open-donate-modal][data-amount]");if(!a)return;let s=parseInt(a.getAttribute("data-amount")||"0",10)||0,u=Math.max(10,Math.round(s*.1));window.dispatchEvent(new CustomEvent("fc:donate:open",{detail:{amount:u}}))},{passive:!0});(async()=>{if(!h("#paypal-buttons")||!window.paypal)return;let a=h("#donation-amount"),s=()=>Math.max(1,parseInt(a?.value||"0",10)||0);try{await window.paypal.Buttons({createOrder:async()=>(await(await fetch("/api/payments/paypal/order",{method:"POST",headers:{"Content-Type":"application/json",Accept:"application/json"},credentials:"same-origin",body:JSON.stringify({amount:s()})})).json()).id,onApprove:async u=>{await fetch(`/api/payments/paypal/capture/${u.orderID}`,{method:"POST",credentials:"same-origin"});try{window.confetti?.({particleCount:120,spread:70,origin:{y:.7}})}catch{}alert("✅ Thank you! Your sponsorship was captured.")}}).render("#paypal-buttons")}catch{}})();ne=h("#sponsors-hub");if(ne&&"IntersectionObserver"in window){let o=Pe(()=>fetch("/api/metrics/impression",{method:"POST",headers:{"Content-Type":"application/json"},credentials:"same-origin",body:JSON.stringify({key:"sponsors_hub"})}).catch(()=>{}));new IntersectionObserver(a=>a.forEach(s=>{s.isIntersecting&&o()}),{threshold:.2}).observe(ne)}document.addEventListener("click",o=>{let a=o.target.closest('a[rel~="sponsored"], a[data-sponsor]');a&&fetch("/api/metrics/click",{method:"POST",headers:{"Content-Type":"application/json"},credentials:"same-origin",body:JSON.stringify({key:a.getAttribute("href")||"sponsor",name:a.dataset.sponsorName||""})}).catch(()=>{})},{passive:!0})});(()=>{"use strict";if(window.__FC_APP_INIT__)return;window.__FC_APP_INIT__=!0;let o=document.documentElement;o.classList.add("js"),o.classList.remove("no-js"),o.setAttribute("data-fc-app","true");let a=o.getAttribute("data-env")||window.APP_ENV||"production",s=/dev|local/.test(String(a).toLowerCase()),u=e=>!!(window.matchMedia&&window.matchMedia(e).matches),l={reducedMotion:u("(prefers-reduced-motion: reduce)"),reducedData:!!(navigator.connection&&(navigator.connection.saveData||String(navigator.connection.effectiveType||"").includes("2g"))),highContrast:u("(prefers-contrast: more)")};(l.reducedMotion||l.reducedData)&&o.classList.add("fc-reduced");let f=(e,t=document)=>t.querySelector(e),g=(e,t=document)=>Array.from(t.querySelectorAll(e)),S=(e,t,n)=>{let r=c=>{try{t(c)}finally{window.removeEventListener(e,r,n)}};window.addEventListener(e,r,n)},b=(e,t=1200)=>"requestIdleCallback"in window?window.requestIdleCallback(e,{timeout:t}):setTimeout(e,0),x=e=>requestAnimationFrame(e),oe=e=>b(()=>x(e)),L=f('meta[name="csp-nonce"]')?.content||"";if(!L)try{L=document.currentScript?.nonce||""}catch{}let q=e=>(L&&e.setAttribute("nonce",L),e),ae=e=>{try{let t=document.cookie.match(new RegExp("(^|;\\s*)"+e.replace(/[.*+?^${}()|[\]\\]/g,"\\$&")+"=([^;]*)"));return t?decodeURIComponent(t[2]):""}catch{return""}},k=()=>f('meta[name="csrf-token"]')?.content||ae("csrf_token")||"",T=null;try{T=new BroadcastChannel("fc_ui")}catch{}let p=(e,t)=>window.dispatchEvent(new CustomEvent(e,{detail:t})),se=(e,t,n)=>(window.addEventListener(e,t,n),()=>window.removeEventListener(e,t,n)),ce=e=>{try{let t=typeof e=="string"?new URL(e,location.href):e instanceof Request?new URL(e.url,location.href):e?.url?new URL(e.url,location.href):null;return!t||t.origin===location.origin}catch{return!1}},R=(e=location.href)=>Object.fromEntries(new URL(e).searchParams.entries()),D=e=>{let t=new URLSearchParams;return Object.entries(e||{}).forEach(([n,r])=>{r==null||r===""||(Array.isArray(r)?r.forEach(c=>t.append(n,c)):t.set(n,String(r)))}),t.toString()},_={get(e,t=null){try{let n=localStorage.getItem(e);return n?JSON.parse(n):t}catch{return t}},set(e,t){try{localStorage.setItem(e,JSON.stringify(t))}catch{}},del(e){try{localStorage.removeItem(e)}catch{}}},M=(e,t=null)=>{let n=_.get(e);return n?n.t&&Date.now()>n.t?(_.del(e),t):n.v??t:t},$=(e,t,n)=>_.set(e,{v:t,t:n?Date.now()+n:0}),j=window.fetch?window.fetch.bind(window):null,ie=(e,t)=>{let n=new AbortController,r=setTimeout(()=>n.abort(new DOMException("Timeout","AbortError")),e);return t?.addEventListener?.("abort",()=>{try{clearTimeout(r),n.abort(t.reason)}catch{}},{once:!0}),{signal:n.signal,cancel:()=>clearTimeout(r)}};async function P(e,t={},{timeout:n=12e3,retries:r=0}={}){if(!j)throw new Error("fetch not available");let c=String(t.method||"GET").toUpperCase(),i=ce(e),d=new Headers(t.headers||{});d.has("Accept")||d.set("Accept","application/json, text/html;q=0.9, */*;q=0.8"),i&&!d.has("X-Requested-With")&&d.set("X-Requested-With","XMLHttpRequest");let v=!["GET","HEAD","OPTIONS","TRACE"].includes(c);if(i&&v&&!d.has("X-CSRFToken")){let y=k();y&&d.set("X-CSRFToken",y)}let m=t.signal,{signal:N,cancel:ve}=ie(n,m),Q=0;for(;;)try{let y=await j(e,{credentials:"same-origin",...t,headers:d,signal:N});return ve(),y}catch(y){if(!(!v&&i&&(y?.name==="AbortError"||/NetworkError|load failed|Failed to fetch/i.test(String(y?.message||"")))&&Q<r))throw y;await new Promise(Ee=>setTimeout(Ee,300*Math.pow(2,Q++)))}}async function F(e,t={},n={}){let r=await P(e,t,n);if(!r.ok){let i=await r.text().catch(()=>""),d=new Error(`HTTP ${r.status} ${r.statusText}`);throw d.status=r.status,d.body=i,d}return r.status===204?null:(r.headers.get("content-type")||"").includes("application/json")?r.json():r.text()}async function de(e,t,n={},r={}){let c=t instanceof FormData?t:JSON.stringify(t??{}),i=new Headers(n.headers||{});return!(t instanceof FormData)&&!i.has("Content-Type")&&i.set("Content-Type","application/json"),F(e,{method:"POST",body:c,headers:i,...n},r)}let U={money(e,{currency:t=f("[data-currency]")?.dataset.currency||"USD",locale:n=f("[data-locale]")?.dataset.locale||navigator.language||"en-US",maximumFractionDigits:r=0,notation:c="standard"}={}){try{return new Intl.NumberFormat(n,{style:"currency",currency:t,maximumFractionDigits:r,notation:c}).format(e)}catch{return`$${Math.round(+e||0).toLocaleString()}`}},pct(e){return`${Math.round(+e||0)}%`}};window.fc=Object.assign(window.fc||{},{env:a,dev:s,prefs:l,bus:T,csrf:k,on:se,emit:p,$:f,$$:g,idle:b,raf:x,defer:oe,fetchJSON:F,postJSON:de,fetchSafe:P,fmt:U,util:{parseQS:R,toQS:D,storage:_,ttlGet:M,ttlSet:$}}),j&&(window.fetch=(e,t={})=>P(e,t));let B=(e=document)=>{g("a[href]",e).forEach(t=>{try{new URL(t.href,location.href).origin!==location.origin&&(t.rel=(t.rel||"").split(/\s+/).filter(Boolean).concat(["noopener","noreferrer"]).join(" "),t.target||(t.target="_blank"))}catch{}})},J="fc_ref_ctx",ue=1e3*60*60*24*7,le=()=>{let e=R(),t={ref:e.ref||e.player||e.captain||e.athlete||"",team:e.team||e.squad||"",camp:e.campaign||e.camp||"",utm_source:e.utm_source||(e.ref?"p2p-ref":""),utm_medium:e.utm_medium||(e.player?"player":e.team?"team":"site"),utm_campaign:e.utm_campaign||e.campaign||"fundchamps"};return Object.fromEntries(Object.entries(t).filter(([,n])=>n))},w=Object.assign({},M(J,{}),le());Object.keys(w).length&&$(J,w,ue);let C=(e,t={})=>{try{let n=new URL(e,location.href),r=Object.fromEntries(n.searchParams.entries()),c={...w,...r,...t},i=D(c);return n.search=i?`?${i}`:"",n.toString()}catch{return e}},H=(e=document)=>{Object.keys(w).length>0&&(g('a[href][data-donate], a[href*="donate"], a[href*="payments"], a[data-cta="donate"]',e).forEach(n=>{n.href=C(n.href)}),g('form[action*="donate"], form[action*="payments"], form[data-donate]',e).forEach(n=>{let r=(c,i)=>{if(!i)return;let d=n.querySelector(`input[name="${c}"]`);d||(d=document.createElement("input"),d.type="hidden",d.name=c,n.appendChild(d)),d.value=i};Object.entries(w).forEach(([c,i])=>r(c,i))}))},me=new MutationObserver(e=>{for(let t of e)t.addedNodes&&t.addedNodes.length&&t.addedNodes.forEach(n=>{n.nodeType===1&&(H(n),B(n),X(n))})}),fe=!!navigator.share,W=async(e={})=>{let t=C(e.url||location.href),n={title:e.title||document.title,text:e.text||"Fuel the Season. Fund the Future.",url:t};try{fe?await navigator.share(n):(await navigator.clipboard.writeText(t),p("fc:copied",{url:t}))}catch{}},X=(e=document)=>{g("[data-share]",e).forEach(t=>{t.__wiredShare||(t.__wiredShare=!0,t.addEventListener("click",async()=>{try{let n=t.getAttribute("data-share"),r=n?JSON.parse(n):{};r.url||(r.url=location.href),W(r),t.classList.add("ring-2"),setTimeout(()=>t.classList.remove("ring-2"),500)}catch{W()}},{passive:!0}))})},pe=()=>{let e=document.querySelector('[data-cta="donate"], .fc-hero-cta, a[href*="donate"]');if(!e)return;let t=new IntersectionObserver(n=>{n.forEach(r=>{if(r.isIntersecting){try{e.setAttribute("tabindex","0"),setTimeout(()=>e.focus({preventScroll:!0}),250)}catch{}t.disconnect()}})},{rootMargin:"0px 0px -60% 0px",threshold:.4});t.observe(e)},he=()=>{addEventListener("keydown",e=>{if((e.key==="d"||e.key==="D")&&!/input|textarea|select/i.test(e.target.tagName)){let t=document.querySelector('[data-cta="donate"], .fc-hero-cta, a[href*="donate"]');if(t)try{t.click()}catch{}}},{passive:!0})},we=()=>{if(!("io"in window||!(document.getElementById("donor-ticker")||document.getElementById("sponsor-leaderboard"))))try{let t=new EventSource("/sse/donations");t.addEventListener("donation",n=>{try{let r=JSON.parse(n.data);p("fc:donation",r);let c=f("#donor-ticker .dt-track");if(c){let i=document.createElement("span");i.className="dt-item";let d=document.createElement("strong");d.textContent=r.name||"Anonymous";let v=document.createElement("i");v.textContent=r.amount?` — ${U.money(r.amount)}`:"",i.append(d,v),c.prepend(i)}}catch{}}),S("pagehide",()=>{try{t.close()}catch{}})}catch{}},A=()=>p("fc:network",{online:navigator.onLine});window.addEventListener("online",A,{passive:!0}),window.addEventListener("offline",A,{passive:!0}),S("DOMContentLoaded",A),window.addEventListener("visibilitychange",()=>p("fc:visibility",{hidden:document.hidden}),{passive:!0}),window.addEventListener("pagehide",()=>p("fc:pagehide"),{passive:!0});try{if("PerformanceObserver"in window){let e=new PerformanceObserver(t=>{for(let n of t.getEntries()){(window.dataLayer=window.dataLayer||[]).push({event:"fc_lcp_seen"}),e.disconnect();break}});e.observe({type:"largest-contentful-paint",buffered:!0})}}catch{}let V=0,G=e=>{let t=Date.now();return t-V<e?!1:(V=t,!0)};window.addEventListener("error",e=>{G(1500)&&p("fc:error",{type:"error",error:e.error||e.message})}),window.addEventListener("unhandledrejection",e=>{G(1500)&&p("fc:error",{type:"rejection",error:e.reason})});let ye=(e,{type:t="module",async:n=!0,deferAttr:r=!0,crossOrigin:c,integrity:i}={})=>new Promise((d,v)=>{let m=q(document.createElement("script"));m.src=e,m.type=t,n&&(m.async=!0),r&&(m.defer=!0),c&&(m.crossOrigin=c),i&&(m.integrity=i),m.onload=()=>d(),m.onerror=N=>v(N),document.head.appendChild(m)}),ge=(e,{media:t="all"}={})=>new Promise((n,r)=>{let c=q(document.createElement("link"));c.rel="stylesheet",c.href=e,c.media=t,c.onload=()=>n(),c.onerror=i=>r(i),document.head.appendChild(c)});Object.assign(window.fc,{loadScript:ye,loadStyle:ge,makeTrackedUrl:C});let K=async()=>{let e=(n,r)=>import(n).then(c=>typeof c.default=="function"?c.default():void 0).catch(c=>{});if(await Promise.allSettled([e("./site.js","site.js"),e("./sponsor.js","sponsor.js"),e("./fundraiser.js","fundraiser.js")]),!!(document.getElementById("sponsor-donation-form")||document.getElementById("stripe-payment-element")||document.getElementById("paypal-buttons"))&&await Promise.resolve().then(()=>(re(),Ae)).catch(n=>{}),!("io"in window)&&document.getElementById("sponsor-leaderboard"))try{await import("./vendor/socketio.mjs")}catch{}try{let{default:n}=await import("alpinejs");window.Alpine=n,n.store?.("fc",{env:a,dev:s,csrf:k(),ref:w}),b(()=>n.start())}catch{}if(b(async()=>{try{let n=o.hasAttribute("data-pwa")||/prod/i.test(a);"serviceWorker"in navigator&&n&&(await navigator.serviceWorker.register("/static/js/elite-sw.js",{scope:"/"}),p("fc:sw:ready"))}catch{}}),H(document),B(document),X(document),pe(),he(),we(),me.observe(document.body,{subtree:!0,childList:!0}),p("fc:ready",{env:a,dev:s,prefs:l,ref:w}),T)try{T.postMessage({t:"fc:ready",env:a,ref:w})}catch{}if(s){let n=performance.getEntriesByType?.("navigation")?.[0]}};document.readyState==="loading"?document.addEventListener("DOMContentLoaded",K,{once:!0}):K()})();})();
