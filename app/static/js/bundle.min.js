/* FundChamps bundle | production | 920a5a27 | 2025-09-02T01:16:24.140Z */
(()=>{var te=Object.create;var x=Object.defineProperty;var ne=Object.getOwnPropertyDescriptor;var oe=Object.getOwnPropertyNames;var re=Object.getPrototypeOf,ae=Object.prototype.hasOwnProperty;var $=(t=>typeof require<"u"?require:typeof Proxy<"u"?new Proxy(t,{get:(o,r)=>(typeof require<"u"?require:o)[r]}):t)(function(t){if(typeof require<"u")return require.apply(this,arguments);throw Error('Dynamic require of "'+t+'" is not supported')});var se=(t,o)=>()=>(t&&(o=t(t=0)),o);var ie=(t,o,r,c)=>{if(o&&typeof o=="object"||typeof o=="function")for(let u of oe(o))!ae.call(t,u)&&u!==r&&x(t,u,{get:()=>o[u],enumerable:!(c=ne(o,u))||c.enumerable});return t};var F=(t,o,r)=>(r=t!=null?te(re(t)):{},ie(o||!t||!t.__esModule?x(r,"default",{value:t,enumerable:!0}):r,t));var ue={};async function de(){if(!U||!window.Stripe)return null;if(w)return w;w=window.Stripe(U),I=w.elements({appearance:{theme:"night"}});let t=y("#stripe-payment-element");return t&&(X=I.create("payment",{fields:{billingDetails:"never"}}),X.mount(t)),w}var y,ce,U,w,I,X,L,le,J,W=se(()=>{y=(t,o=document)=>o.querySelector(t),ce=(t,o,r)=>(window.addEventListener(t,o,r),()=>window.removeEventListener(t,o,r)),U=document.querySelector('meta[name="stripe-pk"]')?.content||window.__STRIPE_PK||"";ce("fc:donate:open",t=>{let o=t?.detail?.amount,r=y("#donation-amount");r&&Number.isFinite(+o)&&(r.value=String(o),r.dispatchEvent(new Event("input",{bubbles:!0})));let c=document.getElementById("donation-modal");c?.showModal&&c.showModal()},{passive:!0});L=document.getElementById("sponsor-donation-form");L&&L.addEventListener("submit",async t=>{if(((L.querySelector('input[name="payment_method"]:checked')||{}).value||"stripe")!=="stripe")return;t.preventDefault();let r=parseFloat((y("#donation-amount")||{}).value||"0")||0,c=(y("#donor-name")||{}).value||"Supporter",u=(y("#donor-email")||{}).value||"";if(r<=0)return;await de();let h=await fetch("/api/payments/stripe/intent",{method:"POST",headers:{"Content-Type":"application/json",Accept:"application/json"},credentials:"same-origin",body:JSON.stringify({amount:r,name:c,email:u,frequency:(L.querySelector('input[name="frequency"]:checked')||{}).value||"once"})}),{client_secret:k}=await h.json(),{error:g}=await w.confirmPayment({elements:I,clientSecret:k,confirmParams:{return_url:window.location.href}});g&&alert("Payment error: "+(g.message||"Please try again."))});document.addEventListener("click",t=>{let o=t.target.closest("[data-open-donate-modal][data-amount]");if(!o)return;let r=parseInt(o.getAttribute("data-amount")||"0",10)||0,c=Math.max(10,Math.round(r*.1));window.dispatchEvent(new CustomEvent("fc:donate:open",{detail:{amount:c}}))},{passive:!0});(async()=>{if(!document.getElementById("paypal-buttons")||!window.paypal)return;let o=document.getElementById("donation-amount"),r=()=>Math.max(1,parseInt(o?.value||"0",10)||0);await window.paypal.Buttons({createOrder:async()=>(await(await fetch("/api/payments/paypal/order",{method:"POST",headers:{"Content-Type":"application/json",Accept:"application/json"},credentials:"same-origin",body:JSON.stringify({amount:r()})})).json()).id,onApprove:async c=>{await fetch(`/api/payments/paypal/capture/${c.orderID}`,{method:"POST",credentials:"same-origin"});try{window.confetti?.({particleCount:120,spread:70,origin:{y:.7}})}catch{}alert("Thank you! Your sponsorship was captured.")}}).render("#paypal-buttons")})();le=t=>{let o=!1;return(...r)=>{o||(o=!0,t(...r))}},J=document.getElementById("sponsors-hub");if(J&&"IntersectionObserver"in window){let t=le(()=>fetch("/api/metrics/impression",{method:"POST",headers:{"Content-Type":"application/json"},credentials:"same-origin",body:JSON.stringify({key:"sponsors_hub"})}).catch(()=>{}));new IntersectionObserver(o=>o.forEach(r=>{r.isIntersecting&&t()}),{threshold:.2}).observe(J)}document.addEventListener("click",t=>{let o=t.target.closest('a[rel~="sponsored"], a[data-sponsor]');o&&fetch("/api/metrics/click",{method:"POST",headers:{"Content-Type":"application/json"},credentials:"same-origin",body:JSON.stringify({key:o.getAttribute("href")||"sponsor",name:o.getAttribute("data-sponsor-name")||""})}).catch(()=>{})},{passive:!0})});(()=>{"use strict";if(window.__FC_APP_INIT__)return;window.__FC_APP_INIT__=!0;let t=document.documentElement;t.classList.add("js"),t.classList.remove("no-js"),t.setAttribute("data-fc-app","true");let o=t.getAttribute("data-env")||window.APP_ENV||"production",r=/dev|local/.test(String(o).toLowerCase()),c=e=>!!(window.matchMedia&&window.matchMedia(e).matches),u={reducedMotion:c("(prefers-reduced-motion: reduce)"),reducedData:!!(navigator.connection&&(navigator.connection.saveData||String(navigator.connection.effectiveType||"").includes("2g"))),highContrast:c("(prefers-contrast: more)")};(u.reducedMotion||u.reducedData)&&t.classList.add("fc-reduced");let h=(e,n=document)=>n.querySelector(e),k=(e,n=document)=>Array.from(n.querySelectorAll(e)),g=(e,n,a)=>{let s=i=>{try{n(i)}finally{window.removeEventListener(e,s,a)}};window.addEventListener(e,s,a)},v=h('meta[name="csp-nonce"]')?.content||"";if(!v)try{v=document.currentScript?.nonce||""}catch{}let _=e=>(v&&e.setAttribute("nonce",v),e),H=e=>{try{let n=document.cookie.match(new RegExp("(^|;\\s*)"+e.replace(/[.*+?^${}()|[\]\\]/g,"\\$&")+"=([^;]*)"));return n?decodeURIComponent(n[2]):""}catch{return""}},E=()=>h('meta[name="csrf-token"]')?.content||H("csrf_token")||"",b=null;try{b=new BroadcastChannel("fc_ui")}catch{}let p=(e,n)=>window.dispatchEvent(new CustomEvent(e,{detail:n})),V=(e,n,a)=>(window.addEventListener(e,n,a),()=>window.removeEventListener(e,n,a)),O=e=>{try{let n=typeof e=="string"?new URL(e,location.href):e instanceof Request?new URL(e.url,location.href):e?.url?new URL(e.url,location.href):null;return!n||n.origin===location.origin}catch{return!1}},S=(e,n=1200)=>"requestIdleCallback"in window?window.requestIdleCallback(e,{timeout:n}):setTimeout(e,0),q=e=>requestAnimationFrame(e),G=e=>S(()=>q(e)),K=(e,{type:n="module",async:a=!0,deferAttr:s=!0,crossOrigin:i,integrity:d}={})=>new Promise((l,T)=>{let m=_(document.createElement("script"));m.src=e,m.type=n,a&&(m.async=!0),s&&(m.defer=!0),i&&(m.crossOrigin=i),d&&(m.integrity=d),m.onload=()=>l(),m.onerror=j=>T(j),document.head.appendChild(m)}),Y=(e,{media:n="all"}={})=>new Promise((a,s)=>{let i=_(document.createElement("link"));i.rel="stylesheet",i.href=e,i.media=n,i.onload=()=>a(),i.onerror=d=>s(d),document.head.appendChild(i)}),C=window.fetch?window.fetch.bind(window):null,z=(e,n)=>{let a=new AbortController,s=setTimeout(()=>a.abort(new DOMException("Timeout","AbortError")),e);return n?.addEventListener?.("abort",()=>{try{clearTimeout(s),a.abort(n.reason)}catch{}},{once:!0}),{signal:a.signal,cancel:()=>clearTimeout(s)}};async function A(e,n={},{timeout:a=12e3,retries:s=0}={}){if(!C)throw new Error("fetch not available");let i=String(n.method||"GET").toUpperCase(),d=O(e),l=new Headers(n.headers||{});l.has("Accept")||l.set("Accept","application/json, text/html;q=0.9, */*;q=0.8"),d&&!l.has("X-Requested-With")&&l.set("X-Requested-With","XMLHttpRequest");let T=!["GET","HEAD","OPTIONS","TRACE"].includes(i);if(d&&T&&!l.has("X-CSRFToken")){let f=E();f&&l.set("X-CSRFToken",f)}let m=n.signal,{signal:j,cancel:Z}=z(a,m),D=0;for(;;)try{let f=await C(e,{credentials:"same-origin",...n,headers:l,signal:j});return Z(),f}catch(f){if(!(!T&&d&&(f?.name==="AbortError"||/NetworkError|load failed|Failed to fetch/i.test(String(f?.message||"")))&&D<s))throw f;await new Promise(ee=>setTimeout(ee,300*Math.pow(2,D++)))}}async function N(e,n={},a={}){let s=await A(e,n,a);if(!s.ok){let d=await s.text().catch(()=>""),l=new Error(`HTTP ${s.status} ${s.statusText}`);throw l.status=s.status,l.body=d,l}return s.status===204?null:(s.headers.get("content-type")||"").includes("application/json")?s.json():s.text()}async function Q(e,n,a={},s={}){let i=n instanceof FormData?n:JSON.stringify(n??{}),d=new Headers(a.headers||{});return!(n instanceof FormData)&&!d.has("Content-Type")&&d.set("Content-Type","application/json"),N(e,{method:"POST",body:i,headers:d,...a},s)}if(window.fc=Object.assign(window.fc||{},{env:o,dev:r,prefs:u,bus:b,csrf:E,on:V,emit:p,$:h,$$:k,idle:S,raf:q,defer:G,loadScript:K,loadStyle:Y,fetchJSON:N,postJSON:Q,fetchSafe:A}),C&&(window.fetch=(e,n={})=>A(e,n)),window.htmx)try{window.htmx.config.withCredentials=!0,window.htmx.config.scrollBehavior="instant",document.body.addEventListener("htmx:configRequest",e=>{if(O(e.detail.path)){e.detail.headers["X-Requested-With"]="XMLHttpRequest";let n=E();n&&(e.detail.headers["X-CSRFToken"]=n)}})}catch{}let P=()=>p("fc:network",{online:navigator.onLine});window.addEventListener("online",P,{passive:!0}),window.addEventListener("offline",P,{passive:!0}),g("DOMContentLoaded",P),window.addEventListener("visibilitychange",()=>p("fc:visibility",{hidden:document.hidden}),{passive:!0}),window.addEventListener("pagehide",()=>p("fc:pagehide"),{passive:!0});let R=0,M=e=>{let n=Date.now();return n-R<e?!1:(R=n,!0)};window.addEventListener("error",e=>{M(1500)&&p("fc:error",{type:"error",error:e.error||e.message})}),window.addEventListener("unhandledrejection",e=>{M(1500)&&p("fc:error",{type:"rejection",error:e.reason})});let B=async()=>{let e=(a,s)=>import(a).then(i=>typeof i.default=="function"?i.default():void 0).catch(i=>{});if(await Promise.allSettled([e("./site.js","site.js"),e("./sponsor.js","sponsor.js"),e("./fundraiser.js","fundraiser.js")]),!!(document.getElementById("sponsor-donation-form")||document.getElementById("stripe-payment-element")||document.getElementById("paypal-buttons"))&&await Promise.resolve().then(()=>(W(),ue)).catch(a=>{}),!("io"in window)&&document.getElementById("sponsor-leaderboard"))try{await import("./vendor/socketio.mjs")}catch{}try{let{default:a}=await import("alpinejs");window.Alpine=a,a.store?.("fc",{env:o,dev:r,csrf:E()}),S(()=>a.start())}catch{}if(S(async()=>{try{let a=t.hasAttribute("data-pwa")||/prod/i.test(o);"serviceWorker"in navigator&&a&&(await navigator.serviceWorker.register("/static/js/elite-sw.js",{scope:"/"}),p("fc:sw:ready"))}catch{}}),p("fc:ready",{env:o,dev:r,prefs:u}),b)try{b.postMessage({t:"fc:ready",env:o})}catch{}if(r){let a=performance.getEntriesByType?.("navigation")?.[0]}};document.readyState==="loading"?document.addEventListener("DOMContentLoaded",B,{once:!0}):B()})();})();
