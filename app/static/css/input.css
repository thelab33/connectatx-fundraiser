/* ==========================================================================
   FundChamps Elite UI — SV-ELITE v3.1 (production, modular)
   Tailwind v4 entry • compact-by-default • a11y-first • motion/contrast safe
   - Unifies buttons/pills
   - Fixes hero overlays (z-index:-1) + pointer-events
   - Stronger forced-colors & reduced-motion guards
   ========================================================================== */

/* ---- Brand Tokens + Prestige (vars first so everything inherits) ---- */
@import url("./brand.tokens.css");
@import url("./fc_prestige.css");

/* ---- Tailwind Core (v4) ---- */
@import "tailwindcss";

/* Keep utilities layer available for @apply ordering (Tailwind v4) */
@reference utilities;

/* ---- Project add-ons (lightweight; anything heavy belongs later) ---- */
@import url("./starforge-glass.css");
@import url("./elite-upgrades.css");

/* ----------------------------------------------------------------------------
   0) Global motion, scrolling, and save-data
---------------------------------------------------------------------------- */
html:focus-within { scroll-behavior: smooth; }

@media (prefers-reduced-motion: reduce){
  *{ animation-duration:.001ms!important; animation-iteration-count:1!important; transition-duration:.001ms!important; }
  html:focus-within{ scroll-behavior:auto; }
}

/* Non-standard but harmless if unsupported; keeps UI legible when available */
@media (prefers-reduced-transparency: reduce){
  .glass,.fc-glass,.hero-glass{ -webkit-backdrop-filter:none!important; backdrop-filter:none!important; background:rgba(0,0,0,.65)!important; }
}

@media (prefers-contrast: more){
  .glass,.fc-glass,.hero-glass{ -webkit-backdrop-filter:none!important; backdrop-filter:none!important; background:rgba(0,0,0,.72)!important; }
}

@media (update: slow), (prefers-reduced-data: reduce){
  html.save-data *{ transition:none!important; animation:none!important; }
}

/* ----------------------------------------------------------------------------
   1) Root tokens (brand + scale) — compact by default
---------------------------------------------------------------------------- */
@layer theme {
  :root{
    /* Brand (black/red/white/gold) */
    --team-black:#0d0d0d; --team-black-900:#0f0f0f; --team-black-light:#171717;
    --team-white:#ffffff;
    --team-red:#d32f2f; --team-red-700:#b71c1c;
    --team-gold:#facc15; --team-gold-2:#fde047; --team-gold-soft: rgba(250,204,21,.16);

    /* Text & surfaces */
    --surface-0:#0f0f10; --surface-1:#141416; --surface-2:#191a1c;
    --text-0:#fafafa; --text-1:#e7e7e7; --text-2:#cfcfcf;

    /* Radii / easing */
    --r:.875rem; --r-lg:1.25rem; --r-xl:1.75rem;
    --ease:cubic-bezier(.2,.8,.2,1);

    /* Compact sizing */
    --scale:.94;
    --btn-fs:calc(.95rem * var(--scale));
    --btn-py:calc(.62rem * var(--scale));
    --btn-px:calc(.96rem * var(--scale));

    /* Glass + meter */
    --glass-bg: rgba(12,12,14,.58);
    --glass-brd: rgba(255,255,255,.12);
    --glass-hi:  rgba(255,255,255,.08);
    --glass-in:  rgba(255,255,255,.05);

    --meter-h: clamp(9px, 1.0vw, 12px);
    --meter-track: linear-gradient(90deg,#eab308 0%, #84cc16 45%, #22c55e 100%);
    --meter-bar:   linear-gradient(90deg,#f2d14b 0%, #34d399 70%, #22c55e 100%);
    --meter-shine: linear-gradient(90deg, rgba(255,255,255,.20), rgba(255,255,255,.06) 35%, rgba(255,255,255,.14));

    /* Focus & a11y */
    --focus-ring: 3px solid var(--team-gold);
    accent-color: var(--team-red);
  }

  :root, [data-theme="dark"], .dark { color-scheme: dark; }
}

/* ----------------------------------------------------------------------------
   2) Base: canvas, rhythm, focus, scrollbars
---------------------------------------------------------------------------- */
@layer base{
  html{ font-size:16px; text-rendering:optimizeLegibility; background:var(--team-black-900); }
  body{ background:var(--team-black-900); color:var(--text-0); -webkit-font-smoothing:antialiased; letter-spacing:.002em; line-height:1.45; }

  .container, .mx-auto{ max-width:72rem; }

  :where(a,button,input,textarea,select,[tabindex]):focus-visible{ outline:var(--focus-ring); outline-offset:3px; }
  :where(a,button,input,textarea,select,[tabindex]):focus:not(:focus-visible){ outline:none; }

  :root{ scrollbar-width:thin; scrollbar-color: var(--team-red) var(--team-black-light); }
  *::-webkit-scrollbar{ width:10px; height:10px; }
  *::-webkit-scrollbar-track{ background:var(--team-black-light); }
  *::-webkit-scrollbar-thumb{
    background:linear-gradient(180deg,var(--team-red),var(--team-gold));
    border:2px solid var(--team-black-light); border-radius:9999px;
  }

  @media (forced-colors: active){
    *{ forced-color-adjust:auto; }
  }
}

/* ----------------------------------------------------------------------------
   3) Type utilities (fluid but restrained)
---------------------------------------------------------------------------- */
@layer utilities{
  .text-fluid-h1{ font-size: clamp(1.85rem, 1.0rem + 2.4vw, 2.6rem); letter-spacing:-.012em; }
  .text-fluid-h2{ font-size: clamp(1.25rem, .9rem + 1.2vw, 1.7rem); letter-spacing:-.008em; }
  .tabular{ font-variant-numeric: tabular-nums; }
  .optical-tight{ letter-spacing:-.01em; }
}

/* ----------------------------------------------------------------------------
   4) Glass + Meter (SV-Elite)
---------------------------------------------------------------------------- */
@layer components{
  .fc-glass,.hero-glass{
    position:relative; background:var(--glass-bg);
    border:1px solid var(--glass-brd);
    box-shadow:0 28px 80px rgba(0,0,0,.62), inset 0 1px 0 var(--glass-hi), inset 0 0 0 1px var(--glass-in);
    border-radius: clamp(24px, 22px + 1vw, 36px);
    contain:paint; will-change:transform,opacity; transform: translateZ(0);
  }
  @supports(backdrop-filter:blur(1px)){
    .fc-glass,.hero-glass{ -webkit-backdrop-filter: blur(16px) saturate(1.05); backdrop-filter: blur(16px) saturate(1.05); }
  }

  .fc-meter{ position:relative; width:100%; height:var(--meter-h); border-radius:9999px; overflow:hidden; border:1px solid rgba(255,255,255,.10); }
  .fc-meter__track{ position:absolute; inset:0; background:var(--meter-track); opacity:.35; }
  .fc-meter__ticks{ position:absolute; inset:0; pointer-events:none; background-image:linear-gradient(to right, rgba(255,255,255,.18) 0 0); background-size:25% 100%; mix-blend-mode:soft-light; opacity:.28; }
  .fc-meter__bar{ height:100%; border-radius:9999px; background:var(--meter-bar); box-shadow: inset 0 0 0 1px rgba(255,255,255,.22), 0 6px 22px rgba(34,197,94,.35); transform-origin:left center; width:100%; transform:scaleX(var(--p,0)); transition: transform .6s var(--ease); }
  .fc-meter__shine{ position:absolute; inset:0; pointer-events:none; background:var(--meter-shine); }

  @media (prefers-reduced-motion: reduce){ .fc-meter__bar{ transition:none; } }
  @media (forced-colors: active){
    .fc-glass,.hero-glass{ border:1px solid CanvasText; box-shadow:none; }
    .fc-meter{ border:1px solid CanvasText; }
  }
}

/* ----------------------------------------------------------------------------
   5) Header/Hero “legacy chip”
---------------------------------------------------------------------------- */
@layer components{
  .legacy-chip{
    --accent: var(--fc-hero-accent, var(--team-gold));
    display:inline-flex; align-items:center; gap:.5rem;
    padding: calc(.42rem * var(--scale)) calc(.95rem * var(--scale));
    border-radius: 1rem;
    background:
      linear-gradient(180deg, rgba(255,255,255,.10), rgba(255,255,255,.05)),
      linear-gradient(90deg, color-mix(in srgb, var(--accent) 86%, #fff) 0%, #fff7cc 100%);
    box-shadow: 0 10px 28px rgba(0,0,0,.35), inset 0 0 0 1px rgba(0,0,0,.25), inset 0 1px 0 rgba(255,255,255,.22);
    -webkit-backdrop-filter: blur(3px) saturate(1.02); backdrop-filter: blur(3px) saturate(1.02);
  }
  .legacy-chip .txt{
    font-weight:900; letter-spacing:-.02em; line-height:1;
    font-size: clamp(18px, 1.25vw + 10px, 24px);
    color:#0b0c0f; text-shadow: 0 .5px 0 #fff6;
  }
  .legacy-chip--lg .txt{ font-size: clamp(20px, 1.6vw + 10px, 28px); }
}

/* ----------------------------------------------------------------------------
   6) Buttons / Pills / Chips
---------------------------------------------------------------------------- */
@layer components{
  .fc-btn{
    display:inline-flex; align-items:center; justify-content:center;
    gap:.5rem; border-radius:999px;
    padding: var(--btn-py) var(--btn-px);
    font-weight:800; font-size: var(--btn-fs);
    transition: transform .08s ease, box-shadow .2s ease, filter .2s ease;
    will-change: transform, filter;
  }
  .fc-btn:focus-visible{ outline:none; box-shadow:0 0 0 3px rgba(255,255,255,.30), 0 0 0 5px rgba(250,204,21,.45); }
  .fc-btn:active{ transform: translateY(1px) scale(.99); }

  .fc-btn-primary{
    color:#0b0b0c;
    background: linear-gradient(180deg, var(--team-gold-2), var(--team-gold));
    box-shadow: 0 8px 24px rgb(250 204 21 / 16%);
    border:1px solid rgba(0,0,0,.16);
  }
  .fc-btn-ghost{ color:#e5e7eb; background:transparent; border:1px solid rgba(255,255,255,.12); }

  .fc-pill{
    display:inline-flex; align-items:center; gap:.5rem;
    padding: calc(.32rem * var(--scale)) calc(.72rem * var(--scale));
    border-radius:999px;
    background: linear-gradient(180deg, rgba(255,255,255,.12), rgba(255,255,255,.06));
    border:1px solid rgba(255,255,255,.18);
    text-shadow:0 1px 0 rgba(0,0,0,.35);
  }
  .fc-pill--dark{ background: color-mix(in srgb, #000 38%, transparent); border-color: rgba(255,255,255,.12); }

  .fc-chip{
    border-radius:.75rem; padding:.45rem .65rem;
    background: color-mix(in srgb, #fff 6%, transparent);
    border:1px solid rgba(255,255,255,.10);
    color:#e5e7eb; font-size:.82rem;
  }
}

/* ----------------------------------------------------------------------------
   7) Hero helpers (full-bleed overlay + gradients) — FIXED Z-INDEX
---------------------------------------------------------------------------- */
#fc-hero{ position:relative; z-index: 0; isolation:isolate; }
#fc-hero::before{
  content:""; position:absolute; inset:0;
  z-index:-1; pointer-events:none;
  background: var(--glass-bg, rgba(12,12,14,.55));
  -webkit-backdrop-filter: blur(14px) saturate(1.05);
  backdrop-filter: blur(14px) saturate(1.05);
}

/* Ensure the contained photo layer sits behind hero content as well */
#fc-hero .fc-hero-glass{ position:relative; isolation:isolate; }
#fc-hero .fc-hero-glass::before{
  content:""; position:absolute; inset:0; z-index:-1; pointer-events:none;
  /* background-image/position are set inline by template via CSS vars */
  border-radius:inherit;
}

.fc-hero-grad{ background: linear-gradient(to bottom, rgba(0,0,0,.82), rgba(0,0,0,.44), rgba(0,0,0,.22)); }
.fc-veil{ background: rgba(0,0,0,.20); }
@supports(backdrop-filter:blur(1px)){ .fc-veil{ -webkit-backdrop-filter: blur(18px); backdrop-filter: blur(18px); } }
.fc-vignette{ background: radial-gradient(120% 70% at 50% 20%, rgba(0,0,0,.28), transparent 60%); }

/* ----------------------------------------------------------------------------
   8) Cards: Impact buckets / Tiers (tightened)
---------------------------------------------------------------------------- */
@layer components{
  .fc-card{
    background: rgba(255,255,255,.04);
    border:1px solid rgba(255,255,255,.10);
    border-radius: var(--r-lg);
    padding: clamp(1.0rem, .8rem + 1vw, 1.25rem);
  }
  .fc-card h3{ font-size:1rem; font-weight:800; letter-spacing:-.01em; }
  .fc-card .meta{ font-size:.85rem; color:#d4d4d8; }
}

/* ----------------------------------------------------------------------------
   9) Header nav (minimal polish; compact)
---------------------------------------------------------------------------- */
@layer components{
  .hdr-nav a{
    all:unset; position:relative; display:inline-block;
    padding:.45rem .4rem; margin-inline:.25rem; cursor:pointer;
    color:#e5e7eb; font-weight:700; border-radius:.5rem;
    transition:color .15s,opacity .15s,background .15s;
  }
  @media (hover:hover){ .hdr-nav a:hover{ color:var(--team-gold); background:rgb(255 255 255 / .05); } }
  .hdr-nav a.active{ color:var(--team-gold); }
  .hdr-nav a.active::after{
    content:""; position:absolute; left:.2rem; right:.2rem; bottom:.12rem; height:2px; border-radius:2px;
    background: linear-gradient(90deg, var(--team-gold), #fff7cc);
  }
}

/* ----------------------------------------------------------------------------
   10) Compact/dense toggles (optional; do not change rem base)
---------------------------------------------------------------------------- */
:where(html,body)[data-compact]{
  --scale:.90;
  --btn-fs:calc(.92rem * var(--scale));
  --btn-py:calc(.55rem * var(--scale));
  --btn-px:calc(.9rem  * var(--scale));
  --meter-h: clamp(8px, .9vw, 11px);
}

/* Ensure hero content always sits above its backgrounds */
#fc-hero .fc-hero-glass > *{ position:relative; z-index: 1; }
