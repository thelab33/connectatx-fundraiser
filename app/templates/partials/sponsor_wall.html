<!-- Sponsor Wall Floating Widget Container -->
<section
  id="sponsor-wall-widget"
  class="fixed bottom-8 right-8 z-50 max-w-md w-full max-h-[80vh] rounded-3xl bg-zinc-900/95 shadow-2xl ring-2 ring-yellow-400 ring-opacity-60 backdrop-blur-md opacity-0 pointer-events-none transition-opacity duration-500"
  role="dialog"
  aria-modal="true"
  aria-labelledby="sponsor-wall-title"
  aria-describedby="sponsor-wall-desc"
  tabindex="-1"
  aria-hidden="true"
>
  <!-- Header -->
  <header class="flex items-center justify-between px-6 py-4 border-b border-yellow-400/30">
    <h2
      id="sponsor-wall-title"
      class="text-3xl font-extrabold bg-gradient-to-r from-yellow-400 via-amber-300 to-yellow-400 bg-clip-text text-transparent drop-shadow-lg"
    >
      ðŸ™Œ Meet Our Champions
    </h2>
    <button
      id="sponsor-wall-close"
      aria-label="Close sponsor wall"
      class="text-yellow-400 hover:text-yellow-200 focus:outline-none focus:ring-2 focus:ring-yellow-400 rounded"
    >
      âœ•
    </button>
  </header>

  <!-- Description / Impact -->
  <div
    id="sponsor-wall-desc"
    class="px-6 py-3 text-yellow-300 font-semibold text-sm sm:text-base border-b border-yellow-400/20"
  >
    {{ sponsors_sorted|length or 0 }} incredible supporters &mdash;
    ${{ sponsors_total|int|comma|default(0) }} raised for our youth!
  </div>

  <!-- Sponsor Grid Scrollable Content -->
  <div class="p-6 overflow-y-auto max-h-[calc(80vh-140px)] grid gap-6 sm:grid-cols-2 md:grid-cols-3 lg:grid-cols-4">
    {% for sponsor in sponsors_sorted %}
      {{ sponsor_card(sponsor, loop.index) }}
    {% endfor %}
    {% set slots = (12 - sponsors_sorted|length) if sponsors_sorted|length < 12 else 0 %}
    {% for _ in range(slots) %}
      <div
        class="flex flex-col items-center justify-center min-h-[260px] rounded-3xl bg-zinc-800/60 text-yellow-300/70 shadow-inner p-6 border border-yellow-400/40 border-dashed"
        role="listitem"
        aria-label="Available sponsorship spot"
        tabindex="0"
      >
        <span class="text-4xl mb-3" aria-hidden="true">âœ¨</span>
        <span class="text-center font-bold mb-1">Your Logo Here</span>
        <span class="text-xs text-zinc-400 mb-4">Limited premium slots left!</span>
        <button
          type="button"
          onclick="openSponsorModal()"
          class="rounded-full bg-yellow-400 px-6 py-2 font-extrabold text-black shadow-lg transition hover:scale-105 focus:outline-none focus:ring-2 focus:ring-yellow-400"
          aria-label="Become a Sponsor"
        >
          ðŸŒŸ Become a Sponsor
        </button>
      </div>
    {% endfor %}
  </div>

  <!-- Footer CTA -->
  <footer class="px-6 py-4 border-t border-yellow-400/20 text-center">
    <button
      type="button"
      onclick="openSponsorModal()"
      class="inline-block rounded-full bg-yellow-400 px-8 py-3 font-extrabold text-black shadow-lg transition hover:bg-yellow-300 focus:outline-none focus:ring-2 focus:ring-yellow-400 active:scale-[0.97]"
      aria-label="Become a Sponsor"
    >
      Become a Sponsor
    </button>
  </footer>
</section>

<!-- Sponsor Wall Toggle Button -->
<button
  id="sponsor-wall-toggle"
  aria-expanded="false"
  aria-controls="sponsor-wall-widget"
  aria-label="Open Sponsor Wall"
  class="fixed bottom-8 right-8 z-50 rounded-full bg-yellow-400 shadow-lg p-4 text-black font-extrabold hover:bg-yellow-300 focus:outline-none focus:ring-2 focus:ring-yellow-400 transition transform active:scale-95"
>
  ðŸ™Œ Sponsors
</button>

<style>
  /* Fade in/out Sponsor Wall */
  #sponsor-wall-widget[aria-hidden="false"] {
    opacity: 1 !important;
    pointer-events: auto !important;
  }
  
  /* Scrollbar styling for sponsor grid */
  #sponsor-wall-widget div[style*="overflow-y:auto"]::-webkit-scrollbar {
    width: 8px;
  }
  #sponsor-wall-widget div[style*="overflow-y:auto"]::-webkit-scrollbar-thumb {
    background-color: rgba(250, 204, 21, 0.5);
    border-radius: 4px;
  }
  
  /* Reduce motion for users with preference set */
  @media (prefers-reduced-motion: reduce) {
    #sponsor-wall-widget,
    #sponsor-wall-toggle {
      transition: none !important;
    }
  }
</style>

<script>
  (() => {
    const toggleBtn = document.getElementById('sponsor-wall-toggle');
    const widget = document.getElementById('sponsor-wall-widget');
    const closeBtn = document.getElementById('sponsor-wall-close');

    function openWidget() {
      widget.setAttribute('aria-hidden', 'false');
      widget.focus();
      toggleBtn.setAttribute('aria-expanded', 'true');
    }

    function closeWidget() {
      widget.setAttribute('aria-hidden', 'true');
      toggleBtn.setAttribute('aria-expanded', 'false');
      toggleBtn.focus();
    }

    toggleBtn.addEventListener('click', () => {
      const isOpen = widget.getAttribute('aria-hidden') === 'false';
      if (isOpen) closeWidget();
      else openWidget();
    });

    closeBtn.addEventListener('click', closeWidget);

    // Close on ESC
    widget.addEventListener('keydown', e => {
      if (e.key === 'Escape') {
        e.preventDefault();
        closeWidget();
      }
    });

    // Focus trap inside widget
    widget.addEventListener('keydown', e => {
      if (e.key === 'Tab') {
        const focusableElements = widget.querySelectorAll(
          'button, [href], input, select, textarea, [tabindex]:not([tabindex="-1"])'
        );
        const first = focusableElements[0];
        const last = focusableElements[focusableElements.length - 1];

        if (e.shiftKey) {
          if (document.activeElement === first) {
            e.preventDefault();
            last.focus();
          }
        } else {
          if (document.activeElement === last) {
            e.preventDefault();
            first.focus();
          }
        }
      }
    });

    // Expose openSponsorModal to global if needed
    window.openSponsorModal = openWidget;
  })();
</script>

