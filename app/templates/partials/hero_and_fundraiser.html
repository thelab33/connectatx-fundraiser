{% from "macros/confetti.html" import launch_confetti %}
{% from "macros/progress.html" import progress_meter %}

{# === HERO VARS === #}
{% set team_name = team.team_name | default('Connect ATX Elite', true) %}
{% set region = team.region | default("Austin, TX", true) %}
{% set logo_src = team.logo if team and team.logo else 'images/team-rings.webp' %}
{% set hero_img = team.hero_image if team and team.hero_image else 'images/connect-atx-team.jpg' %}
{% set fallback_img = url_for('static', filename='images/connect-atx-team.jpg') %}
{% set impact = [
  {"v":"20+", "lbl":"Studentâ€‘Athletes"},
  {"v":"3.5+", "lbl":"GPA Average"},
  {"v":"100%", "lbl":"Funds to Access &amp; Education"}
] %}
{% set raised = stats.raised if stats is defined and stats.raised is defined else 4200 %}
{% set goal = stats.goal if stats is defined and stats.goal is defined else 10000 %}
{% set pct = (raised / goal * 100) | round(1) if goal else 0 %}

<section
  id="hero"
  class="relative isolate overflow-hidden w-full py-24 px-6 sm:px-12 bg-zinc-950/95 text-white min-h-[700px] flex items-center justify-center"
  aria-labelledby="hero-heading"
  tabindex="-1"
  itemscope itemtype="https://schema.org/SportsTeam"
>
  <!-- Background Img (with fallback) -->
  <img
    src="{{ url_for('static', filename=(hero_img if '://' not in hero_img else 'images/' ~ hero_img)) }}"
    alt="{{ team_name }} team photo"
    class="absolute inset-0 w-full h-full object-cover opacity-90 scale-110 animate-kenburns-smooth -z-10"
    style="min-height: 520px; max-height: 100vh"
    loading="eager"
    decoding="async"
    onerror="this.onerror=null;this.src='{{ fallback_img }}';"
    aria-hidden="true"
  />

  <!-- Glassmorphic Overlay -->
  <div class="absolute inset-0 z-10 flex items-center justify-center pointer-events-none">
    <div
      class="glassy-hero-overlay mx-auto"
      style="width: min(97vw, 1320px); height: min(88vw, 670px);"
      aria-hidden="true"
    ></div>
  </div>

  <!-- Gradient Overlay -->
  <div class="absolute inset-0 bg-gradient-to-b from-black/95 via-zinc-950/90 to-zinc-900/95 -z-5"></div>

  <!-- HERO CONTENT -->
  <div class="relative z-30 flex flex-col items-center text-center max-w-4xl w-full mx-auto gap-10">
    <!-- Logo + Title -->
    <div class="flex flex-col items-center gap-2">
      <img
        src="{{ url_for('static', filename=logo_src) }}"
        alt="{{ team_name }} logo"
        class="h-24 w-24 sm:h-28 sm:w-28 rounded-full ring-4 ring-yellow-400/20 bg-white p-1 shadow-xl hover:scale-105 transition-transform"
        loading="lazy"
        decoding="async"
      />
      <h1
        id="hero-heading"
        class="mt-4 text-4xl sm:text-6xl font-extrabold tracking-tight bg-gradient-to-r from-yellow-300 via-yellow-100 to-yellow-50 bg-clip-text text-transparent animate-shine drop-shadow focus:outline-none"
        tabindex="0"
      >
        {{ team_name }}
      </h1>
      <div class="flex gap-2 items-center text-yellow-200 font-semibold text-base sm:text-lg mt-2">
        <svg class="w-5 h-5 text-yellow-300 mr-1" fill="none" viewBox="0 0 16 16"><circle cx="8" cy="8" r="7" stroke="#facc15" stroke-width="2"/></svg>
        <span class="tracking-wider">{{ region }}</span>
        <span class="hidden sm:inline text-yellow-300">|</span>
        <span class="hidden sm:inline">Family, Grit &amp; Honor â€” On and Off the Court</span>
      </div>
    </div>

    <!-- Mission Statement -->
    <p class="max-w-2xl text-yellow-100 font-bold text-lg sm:text-xl leading-relaxed shadow-none mt-1">
      Weâ€™re a <span class="text-yellow-300">family-run AAU program</span> transforming East Austin youth into <span class="text-yellow-300">scholar-athletes, leaders, and community champions</span>.
    </p>

    <!-- Impact Stats -->
    <div class="flex flex-wrap justify-center gap-6 mt-4" role="list" aria-label="Team Impact Stats">
      {% for s in impact %}
      <div class="min-w-[96px] rounded-xl bg-black/75 p-5 text-center shadow-lg hover:bg-yellow-300/10 hover:scale-105 transition-transform duration-300" role="listitem" tabindex="0">
        <div class="text-3xl sm:text-4xl font-extrabold text-yellow-300 animate-shine">{{ s.v }}</div>
        <div class="mt-1 text-xs sm:text-sm uppercase text-yellow-100 tracking-wide">{{ s.lbl }}</div>
      </div>
      {% endfor %}
    </div>

    <!-- Fundraising Progress Bar -->
    <div class="w-full max-w-md bg-zinc-900/90 p-6 rounded-xl ring-1 ring-yellow-400/30 shadow-inner flex flex-col gap-1 items-center mt-2">
      <div class="flex justify-center items-baseline gap-2 text-yellow-300 text-2xl font-black mb-2">
        <span>${{ raised | comma }}</span>
        <span class="text-yellow-100 text-base font-medium">/ ${{ goal | comma }}</span>
        <span class="text-yellow-300 text-sm font-bold">({{ pct }}%)</span>
      </div>
      <div class="mb-2 w-full">{{ progress_meter(raised, goal, 'lg') }}</div>
      <p class="text-xs sm:text-sm text-yellow-100 mt-1">100% of your gift funds gym time, travel, and tutoring.</p>
    </div>

    <!-- VIP CTA Button -->
    <a
      href="#tiers"
      class="inline-flex items-center gap-3 px-8 py-3 rounded-full bg-black border border-yellow-400 text-yellow-200 font-bold shadow-xl hover:bg-yellow-400 hover:text-black hover:scale-105 transition-all ring-1 ring-yellow-400/80 focus-visible:ring-4 focus-visible:ring-yellow-300 animate-vip-bounce"
      aria-label="Become a VIP Sponsor"
    >
      ðŸŒŸ VIP Sponsor
      <svg class="w-5 h-5 animate-sparkle" fill="none" viewBox="0 0 16 16">
        <path d="M8 1v2M8 13v2M1 8h2M13 8h2M4.22 4.22l1.42 1.42M10.36 10.36l1.42 1.42M4.22 11.78l1.42-1.42M10.36 5.64l1.42-1.42" stroke="#fff" stroke-width="1.2" stroke-linecap="round" />
      </svg>
      <span class="hidden sm:inline">Secure Your Spot</span>
    </a>

    <!-- Confetti Container -->
    <div id="hero-confetti" class="pointer-events-none select-none absolute inset-0 z-40"></div>
  </div>
</section>

<!-- Mobile Sticky Donate CTA -->
<a
  href="#donate"
  class="fixed bottom-0 left-0 right-0 z-50 bg-yellow-400 text-zinc-900 py-3 px-6 flex justify-center items-center gap-4 font-extrabold text-lg uppercase tracking-wide cursor-pointer select-none md:hidden shadow-lg hover:bg-yellow-500 transition-colors duration-300 focus-visible:ring-4 focus-visible:ring-yellow-500"
  aria-label="Donate now"
>
  ðŸ’¸ Donate Now
</a>

<style>
/* --- Glassmorphic Hero Overlay --- */
.glassy-hero-overlay {
  border-radius: 32px;
  box-shadow: 0 10px 48px 0 #facc1580, 0 2px 14px 0 #fff9;
  background: linear-gradient(120deg, rgba(250,220,100,0.16) 0%, rgba(55,48,163,0.11) 100%);
  backdrop-filter: blur(14px) saturate(130%);
  -webkit-backdrop-filter: blur(14px) saturate(130%);
  border: 1.5px solid rgba(255,255,255,0.23);
  opacity: 0.90;
  transition: opacity 0.32s cubic-bezier(.4,0,.2,1);
  pointer-events: none;
}
@media (max-width: 640px) {
  .glassy-hero-overlay { border-radius: 16px; min-height: 320px;}
}
/* Animations */
@keyframes shine {
  0%{ background-position:-200px; }
  100%{ background-position:200px; }
}
.animate-shine {
  background-size: 200% auto;
  animation: shine 2.5s linear infinite;
}
@keyframes vip-bounce {
  0%,100% { transform: translateY(0);}
  50% { transform: translateY(-10px);}
}
.animate-vip-bounce { animation: vip-bounce 1.5s infinite cubic-bezier(.75,0,.4,1.2);}
@keyframes sparkle {
  0%,100% { opacity: 0.85;}
  50% { opacity: 1; filter: drop-shadow(0 0 8px #fffbe7);}
}
.animate-sparkle { animation: sparkle 1.2s infinite alternate;}
@keyframes kenburns-smooth {
  0% { transform: scale(1.05);}
  100% { transform: scale(1.12);}
}
.animate-kenburns-smooth { animation: kenburns-smooth 24s linear alternate infinite;}
</style>
<script>
  // Confetti if #vip in URL
  if (window.location.hash === '#vip') {
    import('https://cdn.jsdelivr.net/npm/canvas-confetti@1.6.0/+esm')
      .then(m => m.default({ particleCount: 150, spread: 100, origin: { y: 0.7 } }))
      .catch(()=>{});
  }
  // Tooltip for sparkle icon (a11y, for screenreader users)
  document.querySelectorAll('.animate-sparkle').forEach(el => {
    el.setAttribute('title', 'âœ¨ Premium Opportunity');
  });
  // Focus hero heading on load for accessibility
  document.addEventListener('DOMContentLoaded', () => {
    document.getElementById('hero-heading')?.focus();
  });
</script>

