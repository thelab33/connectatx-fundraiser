{# =================== Elite Program Stats + Events Calendar Partial =================== #}

{% set stats = stats if stats is defined and stats else [
    {'label': 'GPA Avg', 'value': 3.5},
    {'label': 'Student-Athletes', 'value': 22},
    {'label': 'Fundraising Goal ($)', 'value': 10000},
    {'label': 'Active Sponsors', 'value': 17}
] %}
{% set events = events if events is defined and events else [
    {'date': '2025-07-20', 'name': 'AAU Tournament', 'location': 'East Austin Gym', 'time': '10:00 AM', 'is_upcoming': true, 'opponent': 'All Stars', 'result': '', 'highlight': 'Opening tourney!', 'sponsor': None, 'type': 'Tournament'},
    {'date': '2025-07-22', 'name': 'Team Practice', 'location': 'East Austin Gym', 'time': '5:00 PM', 'is_upcoming': false, 'opponent': 'Scrimmage', 'result': 'W', 'highlight': 'Strong win', 'sponsor': 'Austin Realty', 'type': 'Practice'}
] %}

<section id="program-stats-events" class="relative py-16 px-4 sm:px-8 max-w-5xl mx-auto">
  <!-- Animated Heading -->
  <h2
    id="program-calendar-heading"
    class="text-3xl sm:text-4xl font-black bg-gradient-to-r from-yellow-300 via-yellow-200 to-yellow-300 bg-clip-text text-transparent animate-shine text-center mb-10 tracking-tight"
  >
    üóìÔ∏è Program Stats &amp; Events
  </h2>

  <!-- EVENTS CALENDAR -->
  <div class="bg-zinc-900/95 p-7 rounded-3xl shadow-2xl border border-yellow-400/15 animate-pop-in overflow-x-auto">
    <table
      class="min-w-full table-auto text-left text-sm text-zinc-100"
      aria-describedby="program-calendar-heading"
    >
      <thead>
        <tr class="bg-yellow-400 text-zinc-900 select-none">
          <th class="px-4 py-2 rounded-tl-2xl font-bold">Date</th>
          <th class="px-4 py-2 font-bold">Event</th>
          <th class="px-4 py-2 font-bold">Location</th>
          <th class="px-4 py-2 font-bold">Time</th>
          <th class="px-4 py-2 font-bold">Result</th>
          <th class="px-4 py-2 rounded-tr-2xl font-bold">Sponsor</th>
        </tr>
      </thead>
      <tbody>
        {% for event in events %}
          {% set row_classes = [
            'transition-colors',
            event.is_upcoming and 'bg-yellow-400/10 text-yellow-200 font-bold',
            'W' in event.result and 'bg-green-500/10 text-green-200',
            'L' in event.result and 'bg-red-600/10 text-red-100',
            not (event.is_upcoming or 'W' in event.result or 'L' in event.result) and 'bg-zinc-950/90'
          ] | select | join(' ') %}
          <tr class="{{ row_classes }}">
            <td class="px-4 py-2 whitespace-nowrap font-mono tracking-tight">{{ event.date|replace('-', '/') }}</td>
            <td class="px-4 py-2 font-bold">{{ event.name or event.opponent }}</td>
            <td class="px-4 py-2">{{ event.location }}</td>
            <td class="px-4 py-2">{{ event.time }}</td>
            <td class="px-4 py-2" aria-label="Event result">
              {% if 'W' in event.result %}<span class="font-bold text-green-400">üü¢ Win</span>
              {% elif 'L' in event.result %}<span class="font-bold text-red-400">üî¥ Loss</span>
              {% elif event.is_upcoming %}<span class="font-bold text-yellow-300">üü° Upcoming</span>
              {% else %}<span class="text-zinc-400/70">‚Äî</span>{% endif %}
            </td>
            <td class="px-4 py-2">
              {% if event.sponsor %}
                <span class="font-bold text-yellow-300/95 select-text">
                  {{ event.sponsor }}
                  {% if event.sponsor in ['VIP Sponsor', 'Gold‚Äôs Gym', 'Platinum Partner'] %}
                    <span class="ml-1 text-yellow-200 bg-yellow-600/30 rounded px-2 py-0.5 text-xs align-middle font-black select-none">VIP</span>
                  {% endif %}
                </span>
              {% else %}
                <span class="text-zinc-400/60 select-none">‚Äî</span>
              {% endif %}
            </td>
          </tr>
        {% endfor %}
      </tbody>
    </table>
    <div class="mt-7 text-center">
      <a
        href="/calendar"
        class="inline-block bg-yellow-400 hover:bg-yellow-300 text-zinc-900 font-bold py-2 px-6 rounded-full shadow-xl transition-all duration-300 focus-visible:ring-2 focus-visible:ring-yellow-400"
      >
        View Full Calendar
      </a>
    </div>
  </div>
</section>

<style>
  .animate-shine {
    background: linear-gradient(270deg, #fbbf24, #fde68a, #fbbf24);
    background-size: 400% 400%;
    -webkit-background-clip: text;
    background-clip: text;
    -webkit-text-fill-color: transparent;
    animation: subtle-shine 6s ease infinite;
  }
  @keyframes subtle-shine {
    0%, 100% { background-position: 0%; }
    50% { background-position: 100%; }
  }
  @keyframes pop-in {
    0% { opacity: 0; transform: scale(0.87);}
    100% { opacity: 1; transform: scale(1);}
  }
  .animate-pop-in {
    animation: pop-in 0.7s cubic-bezier(.4,1.6,.6,1) both;
  }
  .glassy-card {
    backdrop-filter: blur(12px) saturate(125%);
    -webkit-backdrop-filter: blur(12px) saturate(125%);
    background: linear-gradient(120deg, rgba(255,255,255,0.09) 0%, rgba(250,220,100,0.11) 100%);
    border-radius: 2rem;
    border: 1.5px solid rgba(255,255,255,0.12);
    box-shadow: 0 8px 28px 0 #facc1535, 0 1.5px 10px #fff2;
  }
</style>
<script>
  // Animated stat counters
  document.querySelectorAll(".counter span[data-target]").forEach((counter) => {
    const target = parseFloat(counter.dataset.target) || 0;
    const isInt = Number.isInteger(target);
    let current = 0;
    const step = Math.max(target / 38, 1);

    function animate() {
      current += step;
      if ((step > 0 && current >= target) || (step < 0 && current <= target)) {
        current = target;
      }
      counter.textContent = isInt ? Math.round(current) : current.toFixed(1);
      if (current !== target) {
        requestAnimationFrame(animate);
      }
    }
    animate();
    // Re-run animation if user tabs back in (a11y/focus)
    counter.parentNode.addEventListener('focus', animate);
  });
</script>

