<!DOCTYPE html>
<html
  lang="{{ lang_code|default('en', true) }}"
  data-theme="{{ theme|default('dark', true) }}"
  class="no-js scroll-smooth antialiased bg-zinc-950 text-white font-sans{% if team and team.body_class %} {{ team.body_class }}{% endif %}"
>
<head>
  <meta name="theme-color" content="#facc15"> 
  <meta property="og:type" content="website"> 
  <meta property="og:site_name" content="Connect ATX Elite"> 
  <meta name="twitter:card" content="summary_large_image">
  {# ── Meta & SEO ─────────────────────────────────────────────────────────── #}
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=5" />
  <meta name="robots" content="index,follow,max-image-preview:large" />
  <meta name="theme-color" content="{{ team.theme_color|default('#facc15', true) }}" />
  <meta name="color-scheme" content="dark light" />
  <link rel="canonical" href="{{ request.url_root|trim('/') }}" />

  <meta
    name="description"
    content="{{ team.meta_description|default('Connect ATX Elite — Family-run AAU basketball building future leaders in East Austin.', true) }}"
  />

  {# ── Open Graph / Twitter ──────────────────────────────────────────────── #}
  {% set _raw_og = team.og_image if team and team.og_image else 'images/logo.avif' %}
  {% set ogimg = _raw_og if _raw_og.startswith('http') else url_for('static', filename=_raw_og) %}
  <meta property="og:type" content="website" />
  <meta property="og:title" content="{{ team.og_title|default('Connect ATX Elite | Empowering Youth', true) }}" />
  <meta property="og:description" content="{{ team.og_description|default('Support our basketball journey and invest in our next generation of leaders.', true) }}" />
  <meta property="og:image" content="{{ ogimg }}" />
  <meta property="og:url" content="{{ request.url }}" />
  <meta property="og:site_name" content="{{ team.team_name|default('Connect ATX Elite', true) }}" />
  <meta property="og:image:alt" content="{{ team.og_alt|default(team.og_title|default('Connect ATX Elite', true), true) }}" />

  <meta name="twitter:card" content="summary_large_image" />
  <meta name="twitter:creator" content="{{ team.twitter_handle|default('@ConnectATXElite', true) }}" />

  <title>{% block title %}{{ team.team_name|default('Connect ATX Elite', true) }}{% endblock %}</title>

  {# ── PWA & Icons ───────────────────────────────────────────────────────── #}
  {# <link rel="manifest" href="{{ url_for('static', filename='site.webmanifest', v=asset_version) }}" /> #}
  <link
    rel="icon"
    type="image/png"
    sizes="32x32"
    href="{{ (team and team.favicon) and url_for('static', filename=team.favicon, v=asset_version) or url_for('static', filename='images/favicon.png', v=asset_version) }}"
  />
  <link
    rel="apple-touch-icon"
    href="{{ (team and team.apple_icon) and url_for('static', filename=team.apple_icon, v=asset_version) or url_for('static', filename='images/logo.avif', v=asset_version) }}"
  />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent" />

  {# ── Performance / Preconnect (keep only what you use) ─────────────────── #}
  <link rel="preconnect" href="https://fonts.googleapis.com" />
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
  {# <link rel="preconnect" href="https://js.stripe.com" /> #}
  <link rel="preconnect" href="https://api.stripe.com" />

  {# ── Fonts (self-host later for strict CSP) ────────────────────────────── #}
  <link
    href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600;700&display=swap"
    rel="stylesheet"
  />

  {# ── Styles: preload + main CSS (cache-busted via asset_version) ───────── #}
  <link
    rel="preload"
    href="{{ url_for('static', filename='css/tailwind.min.css', v=asset_version) }}"
    as="style"
  />
  <link
    rel="stylesheet"
    href="{{ url_for('static', filename='css/tailwind.min.css', v=asset_version) }}"
    media="all"
  />

  {# Dev-only: expose input.css to verify Tailwind content scanning #}
  {% if app_env != 'production' %}
    <link rel="stylesheet" href="{{ url_for('static', filename='css/input.css', v=asset_version) }}">
  {% endif %}

  {# Team-specific custom CSS (per-team theme overrides) #}
  {% if team and team.custom_css %}
    <link rel="stylesheet" href="{{ url_for('static', filename='css/' ~ team.custom_css, v=asset_version) }}">
  {% endif %}

  {# Page-specific <head> hooks #}
  <meta name="theme-color" content="#facc15"> 
  <meta property="og:type" content="website"> 
  <meta property="og:site_name" content="Connect ATX Elite"> 
  <meta name="twitter:card" content="summary_large_image">
  {% block head_extra %}{% endblock %}
</head>

<body
  class="bg-zinc-950 text-white font-sans antialiased min-h-screen flex flex-col{% if team and team.body_class %} {{ team.body_class }}{% endif %}"
>
  {# JS capability toggle (use nonce/CSP if enforced) #}
  <script>
    (function(d){d.documentElement.classList.remove('no-js');d.documentElement.classList.add('js');})(document);
  </script>

  {# === Accessible Skip Link === #}
  <a
    href="#main-content"
    class="sr-only focus:not-sr-only absolute top-2 left-2 bg-yellow-400 text-black font-semibold px-3 py-1 rounded-lg z-50"
    tabindex="0"
  >
    Skip to main content
  </a>

  {# === Header & Announcement === #}
  {% block announcement %}{% endblock %}
  {% include 'partials/header_and_announcement.html' ignore missing %}

  {# === HERO (optional per-page) === #}
  {% block hero %}{% endblock %}

  {# === Main Content === #}
  <main
    id="main-content"
    role="main"
    tabindex="-1"
    class="min-h-[60vh] flex flex-col gap-14 max-w-6xl w-full mx-auto px-2 sm:px-8 pt-6"
    style="scroll-margin-top: 80px;"
  >
    {% block content %}{% endblock %}
  </main>

  {# === Footer === #}
  {% include 'partials/footer.html' ignore missing %}

  {# === Global Modals & Popups === #}
  {% block global_modals %}
    {% include 'partials/newsletter.html' ignore missing %}
  {% endblock %}

  {# ── Scripts (deferred, ordered, cache-busted) ─────────────────────────── #}
  {% block pre_scripts %}{% endblock %}

  {# Prefer self-hosted vendor scripts in /static/js/vendor for privacy/CSP #}
  {# <script src="{{ url_for('static', filename='js/vendor/htmx.min.js', v=asset_version) }}" defer></script> #}
  {# <script src="{{ url_for('static', filename='js/vendor/alpinejs.min.js', v=asset_version) }}" defer></script> #}
  {# <script src="{{ url_for('static', filename='js/vendor/socket.io.min.js', v=asset_version) }}" defer></script> #}
  {# <script src="https://unpkg.com/aos@2.3.4/dist/aos.js" defer></script> #}

  <script src="{{ url_for('static', filename='js/main.js', v=asset_version) }}" defer></script>

  {% block scripts %}
    {# Example (only if you actually include AOS): #}
    {# <script defer>
      document.addEventListener('DOMContentLoaded',function(){ if(window.AOS){ AOS.init({ once:true, duration:600 }); } });
    </script> #}
  {% endblock %}
  {% block post_scripts %}{% endblock %}
</body>
</html>

<script src="https://cdn.jsdelivr.net/npm/countup.js@2.0.8/dist/countUp.umd.js"></script>
<div class="w-full text-center py-2 bg-gradient-to-r from-yellow-900 via-yellow-800 to-yellow-900 text-yellow-100 text-xs font-semibold tracking-wide shadow-inner select-none">🏅 Trusted by 500+ Families · AAU Gold Certified · Austin, TX</div>
